---
title: "Webhooks"
sidebarTitle: "Webhooks"
description: "Understanding BeatPass webhook architecture for Stripe payment and payout processing."
keywords: ["beatpass webhooks","stripe webhooks","payment webhooks","payout notifications"]
"og:title": "Webhooks - BeatPass Developer Docs"
"og:description": "Learn how BeatPass processes Stripe webhooks for payments and payouts."
---

## Overview

BeatPass uses **inbound webhooks** to receive payment notifications from Stripe. There is currently no outbound webhook system for external integrations.

<Note>
  BeatPass does not send webhooks to external applications. This page documents how BeatPass receives payment notifications from Stripe.
</Note>

---

## Inbound Webhooks (Stripe)

BeatPass receives webhooks from Stripe to process purchase-related payment events.

### Webhook Endpoint

```
POST /api/stripe/webhook
```

This endpoint receives payment-related events from Stripe's webhook system.

<Note>
  Webhook requests must include a valid `Stripe-Signature` header. Manual requests without proper signatures are rejected.
</Note>

---

## Stripe Events Handled

The webhook controller processes the following Stripe events:

<Tabs>
  <Tab title="Purchase Events">
    <AccordionGroup>
      <Accordion title="payment_intent.succeeded" defaultOpen icon="circle-check">
        <Badge color="green">Success</Badge>
        Completes the purchase and activates the license.
      </Accordion>
      <Accordion title="payment_intent.payment_failed" icon="circle-xmark">
        <Badge color="red">Failed</Badge>
        Records the payment failure. The buyer sees an error on their next visit.
      </Accordion>
      <Accordion title="charge.refunded" icon="rotate-left">
        <Badge color="orange">Refund</Badge>
        Processes the refund (supports both partial and full refunds).
      </Accordion>
    </AccordionGroup>
  </Tab>
  <Tab title="Payout Events">
    <AccordionGroup>
      <Accordion title="payout.created" defaultOpen icon="clock">
        <Badge color="blue">Initiated</Badge>
        Payout initiated to producer's bank account.
      </Accordion>
      <Accordion title="payout.paid" icon="circle-check">
        <Badge color="green">Deposited</Badge>
        Payout deposited successfully.
      </Accordion>
      <Accordion title="payout.failed" icon="circle-xmark">
        <Badge color="red">Failed</Badge>
        Payout failed. Producer is informed of the reason.
      </Accordion>
    </AccordionGroup>
  </Tab>
  <Tab title="Account Events">
    <Accordion title="account.updated" defaultOpen icon="rotate">
      <Badge color="purple">Sync</Badge>
      Updates Stripe Connect account status. Producer is informed if action is required (verification, document upload, etc.).
    </Accordion>
  </Tab>
</Tabs>

---

## How It Works

<Steps>
  <Step title="Payment Initiated">
    User initiates a track purchase via Stripe.js.
  </Step>
  <Step title="Stripe Processes">
    Stripe processes the payment and updates the PaymentIntent status.
  </Step>
  <Step title="Webhook Sent">
    Stripe sends a webhook to BeatPass at `/api/stripe/webhook`.
  </Step>
  <Step title="BeatPass Processes">
    BeatPass verifies the signature and processes the event:

    - Updates purchase/payout records
    - Generates license certificates for successful purchases
    - Marks tracks as sold for exclusive purchases
    - Sends notifications to producers
  </Step>
</Steps>

---

## Webhook Security

### Stripe Signature Verification

All incoming Stripe webhooks are verified using Stripe's standard webhook signature verification. This ensures that webhook payloads are authentic and have not been tampered with.

- Webhooks are validated against a signing secret configured in Stripe
- Invalid signatures result in immediate rejection (400 response)
- All webhook processing is logged for audit purposes

<Warning>
  Webhooks without valid Stripe signatures are rejected. Only Stripe's servers can send valid webhook events.
</Warning>

---

## For Developers

### Testing Webhooks Locally

Use the Stripe CLI to forward webhooks during development:

```bash
# Install Stripe CLI
brew install stripe/stripe-cli/stripe

# Login
stripe login

# Forward webhooks to a local development server
stripe listen --forward-to localhost:8000/api/stripe/webhook

# Forward webhooks to a remote dev server (example)
stripe listen --forward-to https://dev.example.com/api/stripe/webhook
```

### Webhook Events in Stripe Dashboard

Monitor webhook delivery in the Stripe Dashboard:

1. Go to **Developers \> Webhooks**
2. Select your endpoint
3. View recent events and delivery status
4. Retry failed webhooks if needed

---

## No Outbound Webhooks

<Info>
  BeatPass does not currently offer outbound webhooks for external integrations.
</Info>

For real-time updates in your application:

- **Track changes:** Poll the API or use the notifications SSE stream (authenticated)
- **Purchase status:** Use the purchase status endpoint after initiating
- **User events:** Handled client-side via the BeatPass frontend

### Future Considerations

Outbound webhooks for third-party integrations may be considered for future releases. If you have a specific use case, contact support to discuss.

---

## Related Resources

<CardGroup cols={3}>
  <Card title="Commerce & Licensing API" icon="cart-shopping" href="/developers/api-reference/commerce">
    Purchase flow, license certificates, and Stripe Connect endpoints.
  </Card>
  <Card title="Exclusive Licenses" icon="file-certificate" href="/help/downloads-and-licensing/exclusive-licenses">
    How exclusive purchases and licensing work.
  </Card>
  <Card title="Stripe Connect" icon="link" href="/help/earnings/stripe-connect">
    Producer payout setup guide.
  </Card>
</CardGroup>